import{S as j,i as z,s as K,T as W,e as F,b as q,U as X,B as T,h as d,P as Y,k as g,q as E,l as b,m as v,r as D,n as m,I as n,a as R,c as B,Q as Z,J as $,u as tt}from"../../../chunks/index-b30536f4.js";import{r as G,c as J,g as et,e as at,l as M,d as O,f as st}from"../../../chunks/firebase-6ca424c3.js";import{u as lt,a as Q}from"../../../chunks/state-cb440c83.js";import{p as rt}from"../../../chunks/stores-b6bff587.js";import{b as ot}from"../../../chunks/paths-6cd3a76e.js";function nt(r){let t,e=r[12].message+"",a;return{c(){t=g("h2"),a=E(e),this.h()},l(s){t=b(s,"H2",{class:!0});var o=v(t);a=D(o,e),o.forEach(d),this.h()},h(){m(t,"class","mx-auto text-xl")},m(s,o){q(s,t,o),n(t,a)},p:T,d(s){s&&d(t)}}}function ct(r){let t,e,a,s,o,c,y=r[1].name+"",p,f,_,k,I=r[1].price.toLocaleString()+"",P,A,l,i=r[0]?"Add to Cart":"Login first",w,C,L,S,H;return{c(){t=g("div"),e=g("img"),s=R(),o=g("div"),c=g("h1"),p=E(y),f=R(),_=g("p"),k=E("Rp "),P=E(I),A=R(),l=g("button"),w=E(i),this.h()},l(h){t=b(h,"DIV",{class:!0});var u=v(t);e=b(u,"IMG",{class:!0,src:!0,alt:!0}),s=B(u),o=b(u,"DIV",{class:!0});var x=v(o);c=b(x,"H1",{class:!0});var U=v(c);p=D(U,y),U.forEach(d),f=B(x),_=b(x,"P",{class:!0});var N=v(_);k=D(N,"Rp "),P=D(N,I),N.forEach(d),A=B(x),l=b(x,"BUTTON",{class:!0});var V=v(l);w=D(V,i),V.forEach(d),x.forEach(d),u.forEach(d),this.h()},h(){m(e,"class","h-48 w-48"),Z(e.src,a=r[1].image)||m(e,"src",a),m(e,"alt",r[1].name+"-image"),m(c,"class","font-bold text-xl text-black"),m(_,"class","text-2xl"),l.disabled=C=!r[0],m(l,"class",L="mt-4 py-2 w-full rounded-lg text-center font-bold "+(r[0]?"text-white bg-green-400":"text-gray-500 bg-gray-200")),m(o,"class","flex flex-col"),m(t,"class","flex py-4 gap-4")},m(h,u){q(h,t,u),n(t,e),n(t,s),n(t,o),n(o,c),n(c,p),n(o,f),n(o,_),n(_,k),n(_,P),n(o,A),n(o,l),n(l,w),S||(H=$(l,"click",r[3]),S=!0)},p(h,u){u&1&&i!==(i=h[0]?"Add to Cart":"Login first")&&tt(w,i),u&1&&C!==(C=!h[0])&&(l.disabled=C),u&1&&L!==(L="mt-4 py-2 w-full rounded-lg text-center font-bold "+(h[0]?"text-white bg-green-400":"text-gray-500 bg-gray-200"))&&m(l,"class",L)},d(h){h&&d(t),S=!1,H()}}}function it(r){let t,e;return{c(){t=g("span"),e=E("Loading data...")},l(a){t=b(a,"SPAN",{});var s=v(t);e=D(s,"Loading data..."),s.forEach(d)},m(a,s){q(a,t,s),n(t,e)},p:T,d(a){a&&d(t)}}}function dt(r){let t,e={ctx:r,current:null,token:null,hasCatch:!0,pending:it,then:ct,catch:nt,value:1,error:12};return W(r[2],e),{c(){t=F(),e.block.c()},l(a){t=F(),e.block.l(a)},m(a,s){q(a,t,s),e.block.m(a,e.anchor=s),e.mount=()=>t.parentNode,e.anchor=t},p(a,[s]){r=a,X(e,r,s)},i:T,o:T,d(a){a&&d(t),e.block.d(a),e.token=null,e=null}}}function ut(r,t,e){let a;Y(r,rt,l=>e(7,a=l));const s=a.url.searchParams.get("id");let o,c,y,p,f,k=(async()=>{const l=G(O,"products/"+s),i=(await J(l)).val();if(i)return I(),i;throw new Error("Product Not Found")})();lt.subscribe(l=>{e(0,c=l)});const I=async()=>{o=et(at),e(1,f=await k),y={item_id:s,item_name:f.name,price:f.price},p={...y,quantity:1},M(o,"select_item",y)},P=()=>{c||(window.location.href=ot+"/login");const l={...p,image:f.image},i=G(O,"cart/"+c.uid+"/"+p.item_id);J(i).then(w=>{w.val()?Q("This item is already in the cart"):(st(i,l),Q("Item added to cart"),A())})},A=()=>{const l={currency:"IDR",value:p.price,items:[p]};M(o,"add_to_cart",l)};return[c,f,k,P]}class gt extends j{constructor(t){super(),z(this,t,ut,dt,K,{})}}export{gt as default};
